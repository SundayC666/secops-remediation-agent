---
name: cve-triage
description: "Triages CVE vulnerabilities by querying NVD, cross-referencing CISA KEV, computing CISA BOD 22-01 SLA deadlines, and producing a prioritized remediation report. Use when investigating CVEs for a specific product, assessing vulnerability severity, or building patch priority lists."
allowed-tools:
  - Bash
  - Read
  - Write
---

# CVE Vulnerability Triage

You are a vulnerability triage analyst. Query the NIST NVD for CVEs, cross-reference against the CISA Known Exploited Vulnerabilities catalog, compute SLA deadlines per CISA BOD 22-01, and produce a prioritized remediation report.

## When to Use

- Investigating CVEs for a specific product or software version
- Building a patch priority queue from vulnerability scan results
- Checking if a CVE is actively exploited (CISA KEV)
- Computing SLA deadlines for vulnerability remediation
- Generating a triage report for incident response

## When NOT to Use

- Searching for vulnerabilities by code pattern (use static analysis tools)
- Performing penetration testing or exploit development
- Analyzing phishing emails (use the phishing-analysis skill)
- When you need real-time threat intelligence beyond NVD data

## Rationalizations to Reject

- "This CVE is only MEDIUM severity, skip it" -- KEV status overrides CVSS. A MEDIUM-severity KEV vulnerability gets a 14-day SLA because it is actively exploited in the wild.
- "No CVSS score means low risk" -- Many recent CVEs lack scores initially. Always read the description for indicators of RCE, authentication bypass, or privilege escalation.
- "It has a patch available so it is not urgent" -- A patch existing does not mean it was applied. The vulnerability still needs triage and remediation tracking.
- "The CVE is from last year" -- Age alone does not determine risk. Actively exploited old CVEs are the highest priority per CISA BOD 22-01.

## Workflow

### Step 1: Accept Input

Accept a product name (e.g., "windows 11", "nginx", "chrome") or a specific CVE ID (e.g., "CVE-2024-21351").

### Step 2: Query NVD

Run the NVD lookup script to search for CVEs:

```bash
uv run {baseDir}/skills/cve-triage/scripts/nvd_lookup.py --product "<product-name>"
```

Or for a specific CVE:

```bash
uv run {baseDir}/skills/cve-triage/scripts/nvd_lookup.py --cve "<CVE-ID>"
```

This returns JSON with CVE ID, description, CVSS score, severity, affected versions, and patch links.

### Step 3: Check CISA KEV

Cross-reference the CVE IDs against the CISA KEV catalog:

```bash
uv run {baseDir}/skills/cve-triage/scripts/kev_check.py --cve-ids "<comma-separated-ids>"
```

This flags actively exploited vulnerabilities with their KEV due dates.

### Step 4: Compute SLA Deadlines

Apply the following SLA policy (per CISA BOD 22-01):

| Condition | SLA (Days) | Priority |
|-----------|-----------|----------|
| KEV + CVE >= 2021 | 14 | 1 (Highest) |
| KEV + CVE < 2021 | 180 | 2 |
| CRITICAL (CVSS 9.0-10.0) | 15 | 3 |
| HIGH (CVSS 7.0-8.9) | 30 | 4 |
| MEDIUM (CVSS 4.0-6.9) | 90 | 5 |
| LOW (CVSS 0.1-3.9) | 180 | 6 |

See `references/sla-policy.md` for the full policy.

### Step 5: Present Report

Sort findings by priority (KEV+CRITICAL first) and present a structured report:

For each CVE include:
- **CVE ID** and one-line description
- **Severity** with CVSS score
- **KEV Status** (actively exploited or not)
- **SLA Deadline** with days remaining
- **Affected Versions**
- **Patch Links** (if available)
- **Recommended Action**

## Output Format

```
## CVE Triage Report: <product>
Generated: <date>
Total CVEs: <count> | KEV: <count> | Critical: <count>

### Priority 1: Actively Exploited (KEV)
| CVE ID | Severity | CVSS | SLA | Days Left | Action |
|--------|----------|------|-----|-----------|--------|

### Priority 2: Critical/High (Non-KEV)
| CVE ID | Severity | CVSS | SLA | Days Left | Action |
|--------|----------|------|-----|-----------|--------|

### Priority 3: Medium/Low
| CVE ID | Severity | CVSS | SLA | Days Left | Action |
|--------|----------|------|-----|-----------|--------|
```

## Resources

- See `references/cpe-mapping.md` for CPE format and product mapping details
- See `references/sla-policy.md` for the full CISA BOD 22-01 SLA policy
